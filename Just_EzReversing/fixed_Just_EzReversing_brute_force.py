import hashlib

cipher = b'\xd9\xb2\x52\x86\x6a\x25\x98\x6f\xd8\xec\x8a\x6c\x9b\xde\xd2\x75\xc7\x9b\xda\x0e\x66\xf0\x7b\xee\x66\x2a\x68\x40\xb9\x07\xbf\x39\x8d\x36\xb3\x61\xa4\x79\x44\x22\xc7\x06\x81\x58\x6a\x95\x73\x50\x18\x2b\xe0\xc5\xcd\xcd\x50\x72\xbb\x18\x64\xcd\xee\x4d\x3d\x6e\xac\xcb\x66\xf0\xec\xd8\x26\xaa\xc8\x90\x65\x99\x0e\x1d\xa9\x7f\x56\x9b\x3c\xed\x35\x55\xbf\xae\x63\xca\xdb\x65\x58\xa6\xfc\xbe\x33\xd2\xa0\x8e\xee\x4c\x17\x81\x19\x40\xfe\xfb\xc4\xe0\x97\x78\x6b\xa8\x9a\xb4\x18\x23\xaf\x9b\x65\xea\x5d\x23\x30\x31\xb9\xf8\xe4\xa5\x9d\xf8\xb9\x72\x06\x10\x9e\xb4\xb7\xf2\xfe\x52\x8a\x4d\xad\x44\xac\x8c\x02\x28\x5f\x6b\x91\x64\xa0\x84\x92\xa7\x8f\x92\x0a\x5b\x65\x72\x5f\x6a\x3b\xa9\x58\x21\xce\xc6\x1d\xbb\x46\xd3\x2f\xf2\xd4\x5e\x98\x3c\x58\xe9\x6c\x9b\xa3\x3d\x69\x72\x1c\xe8\x51\xf5\x81\x93\x77\x65\x89\x0f\x2a\x70\x6c\x77\xea\x8a\xf3\xcc\xa3\x6c\x71\xeb\x23\x9a\x02\x31\xba\x0c\x6e\x7a\x45\x90\xf0\x62\x42\xad\xc7\x77\xf3\xc2\xc9\x70\x05\x15\x0c\xb7\xb8\x61\x65\xb6\xc2\x3f\xa9\x99\x69\x25\xb6\x10\x71\x0d\x93\xe2\x8c\x59\xa3\xe2\xd5\xc4\x42\x58\xd5\x16\x59\xf9\x62\x79\xc4\x70\xce\x81\x85\xdc\x6e\x02\x9f\xbf\xa8\x17\xdf\xc4\x58\x59\x8a\x5d\x38\xa6\x75\x5f\x7c\x78\xeb\xb4\xc2\x23\xc9\x6f\x8e\x6c\xcc\x29\xf7\x3c\xc2\x8e\x76\xaa\x96\x36\x9a\xbb\xba\x52\xe6\x21\xbf\xa8\x3d\xa8\xe6\x4f\xba\x7d\x08\x34\xd2\x3b\x91\x50\x4b\xed\x68\x59\x01\xdc\x3a\xc5\x38\xf9\x9a\xbb\xc1\xd3\x39\xc2\x77\xc0\x66\x9e\x7b\xc3\x73\xc0\x0a\x5b\x65\x72\x5f\x6a\x3b\xa9\x58\x21\xce\xc6\x1d\xbb\x46\xd3\x85\x3b\xc5\x5c\x10\x41\xf2\x4b\x93\x92\x06\x93\x31\xe6\x53\x36\xf2\x14\xa7\xd4\x2e\x0d\xe5\x87\x5d\x55\x18\x9e\x01\xe2\xe1\x87\x7b\x7c\xd2\x4e\xa6\xf0\x8b\x71\x1c\xf4\x05\x3b\xea\xc4\x3c\xc5\x64\xf3\xbd\x17\x41\xab\x8d\x6b\xa5\x45\xa1\xae\x09\xbb\x87\x28\x8a\x6b\x17\x8d\x3a\xf0\xa5\xa9\xb2\x74\x4c\xa3\x19\x21\xd5\xe2\xbf\xd2\x34\x39\x10\x37\x8a\x1b\x53\x7c\x3c\x80\x36\xa5\xc0\x7e\x20\x63\x84\x97\x17\xd3\x2d\xd1\x9e\x53\x4b\x77\xca\xba\xc5\x17\x20\x63\x84\x97\x17\xd3\x2d\xd1\x9e\x53\x4b\x77\xca\xba\xc5\x17\x20\x63\x84\x97\x17\xd3\x2d\xd1\x9e\x53\x4b\x77\xca\xba\xc5\x17'

def brute_md5_2bytes(digest):
    for x in range(0x10000):
        data = x.to_bytes(2, 'little')  # đổi thành 'big' nếu cần
        if hashlib.md5(data).digest() == digest:
            return data
    return None

result = b''

for i in range(0, len(cipher), 16):
    block = cipher[i:i+16]
    plain = brute_md5_2bytes(block)
    if plain is None:
        print(f"[!] Fail at block {i//16}")
        break
    result += plain
    print(f"[+] Block {i//16}: {plain.hex()}")

print("\nRecovered bytes:", result)

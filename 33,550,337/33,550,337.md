<img width="400" height="500" alt="image" src="https://github.com/user-attachments/assets/d97b0188-7f6f-499e-93f9-9c84aa0b57df" />

Bài này ý tưởng giống như dùng tool [Cheat Engine](https://www.cheatengine.org/) để tìm và thay đổi giá trị của bộ nhớ khi chương trình đang chạy.

Video youtbube tham khảo https://www.youtube.com/watch?v=N5PlpcBit3c&t=

# Mở Ứng dụng để xem yêu cầu đề bài

Challenge cho các bạn một file apk có tên là app-release.apk . Các bạn dùng bất kỳ phần mềm giả lập nào cũng được, ở đây mình dùng phần mềm giả lập [ld player](https://vi.ldplayer.net/) để cài phần mềm.

<img width="1158" height="500" alt="image" src="https://github.com/user-attachments/assets/6289895a-9c01-4175-b60b-ff29a9ca7e24" />

Phần mềm có tên là ripple_of_past. Phần mềm khá đơn giản chỉ có một nút nhấn ***Advance the Cycle*** , một label ***Cycle progress*** cạnh đó có một trường đếm số lần nhấn nút bắt đầu từ 0/33,550,337 và một background màu hồng cùng quả nhạc nền rất chill tiếp sức ae vào buổi đêm =))))))). 

==> *Suy đoán khả năng là khi ấn đủ 33,550,337 lần thì chúng ta sẽ get được flag.*

# Solution

Thay vì chầy cối ấn chay tận 33,550,337 lần thì mình sẽ cố gắng thay đổi giá trị của Cycle progress khi chương trình đang chạy. Lúc này mình nhớ ra là hồi xưa có xem qua phương pháp hack số bông hoa của plant vs zombie bằng  [Cheat Engine](https://www.cheatengine.org/).

Sau một lúc loay hoay tìm tòi trên mạng thì mình tìm thấy một phần mềm có chức năng tương tự là [GameGuardian](https://gameguardian.net/forum/files/file/2-gameguardian/).

Ý tưởng của chúng ta là sẽ dùng phần mềm GameGuardian để sửa đổi giá trị của trường biến đếm ***Cycle progress*** trong ram trở thành 33,550,336. Rồi chúng ta chỉ cần ấn một lần nữa là sẽ có được flag.

# Bắt tay vào thực hiện

Trước hết các bạn cần phải mở quyền root cho máy giả lập android để có thể cài đặt GameGaurd. Trên ld player khá đơn giản, các bạn chỉ cần mở máy lên rồi vào phần setting có hình bánh răng góc màn hình là mở được.

Sau khi mở GameGuardian lên thì sẽ có một cái pop up ở trên màn hình như này.

<img width="120" height="146" alt="image" src="https://github.com/user-attachments/assets/b2b93146-43e0-44a3-b206-b4b90b3e04d1" />

Các bạn ấn nút để cho số đếm lên khoảng vài lần. Ở đây mình sẽ ấn lên khoảng 18 lần :))

Sau đó bạn vô cái pop up của gameguard trên màn hình, chọn phần mềm đang cần hack.

<img width="600" height="400" alt="image" src="https://github.com/user-attachments/assets/b73a5a78-66be-42ee-a317-e62201eb1518" />

Ấn vào hình kính lúp ở góc phải trên cùng rồi nhập số lần chúng ta vứa nhấn (ở đây là 18) ở ô giá trị, loại thì các bạn để là DWORD. Các bạn sẽ thấy phần mềm sẽ trả về các địa chỉ trong ram đang chứa giá trị này.

Lúc này sẽ hiện ra tương đối nhiều địa chỉ, các bạn chỉ cần qua lại phần mềm và ấn thêm vài lần để thay đổi giá trị biến đếm, ở đây mình sẽ ấn thêm cho đủ số 36 :)))). Làm lại bước vừa nãy rồi ấn lọc, cuối cùng các bạn sẽ thấy chỉ còn có một địa chỉ đang chứa giá trị 36. Đây chính là địa chỉ của biến đếm mà chúng ta cần tìm.

<img width="600" height="400" alt="image" src="https://github.com/user-attachments/assets/1697c5c5-414d-4f7b-acd4-30105b666bbc" />

Ấn vào địa chỉ ấy và thay đổi giá trị mà địa chỉ đang nắm giữ thành 33,550,336. Rồi ấn thêm một lần nữa là chúng ta sẽ có được flag.

<img width="600" height="400" alt="image" src="https://github.com/user-attachments/assets/a17c9115-6c07-49c2-b330-7abae5155304" />

flag: KCSC{now stay true thaw winter's rime anew woven memories your boon and like a melody sing our reverie and in our memory pen the end of our journey}
